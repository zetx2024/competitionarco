<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificate Generator with QR</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #qrcode {
            display: none; /* Hide QR code element as it will be used for generating the image */
        }
        .form-container {
            margin-bottom: 20px;
        }
        .certificate {
            width: 800px;
            height: 600px;
            background-color: #f8f8f8;
            border: 2px solid #000;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        .certificate-content {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }
        .qr-code {
            position: absolute;
            bottom: 20px;
            right: 20px;
        }
    </style>
</head>
<body>

    <div class="form-container">
        <h2>Generate Certificates with QR Codes</h2>
        <button type="button" onclick="generateCertificates()">Generate Certificates</button>
    </div>

    <div id="qrcode"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        // Sample JSON Data
        const students = [
            { "name": "Alice Johnson", "institute": "XYZ University", "program": "Computer Science" },
            { "name": "Bob Smith", "institute": "XYZ University", "program": "Mechanical Engineering" },
            { "name": "Charlie Davis", "institute": "XYZ University", "program": "Civil Engineering" }
        ];

        // Function to generate QR code for a student
        function generateQRCode(text, callback) {
            const qrElement = document.getElementById('qrcode');
            qrElement.innerHTML = '';
            const qrCode = new QRCode(qrElement, {
                text: text,
                width: 100,
                height: 100,
                correctLevel: QRCode.CorrectLevel.H
            });
            // Wait for QR code to be generated
            setTimeout(() => {
                const qrCanvas = qrElement.querySelector('canvas');
                const qrDataUrl = qrCanvas.toDataURL('image/png');
                callback(qrDataUrl);
            }, 500); // Delay to ensure QR code is rendered
        }

        // Function to generate certificates for all students
        function generateCertificates() {
            const { jsPDF } = window.jspdf;

            students.forEach((student, index) => {
                // Create a new jsPDF document
                const doc = new jsPDF();

                // Prepare student information
                const qrText = `Name: ${student.name}\nInstitute: ${student.institute}\nProgram: ${student.program}`;
                const certificateTitle = "Certificate of Completion";
                const description = `${student.name} has successfully completed the ${student.program} program at ${student.institute}.`;

                // Generate QR code for the student
                generateQRCode(qrText, (qrDataUrl) => {
                    // Add certificate title
                    doc.setFontSize(24);
                    doc.text(certificateTitle, 105, 40, { align: 'center' });

                    // Add student details
                    doc.setFontSize(16);
                    doc.text(description, 105, 80, { align: 'center' });

                    // Add QR code image
                    doc.addImage(qrDataUrl, 'PNG', 160, 200, 40, 40);

                    // Add some decorative lines (optional)
                    doc.setLineWidth(1);
                    doc.line(20, 50, 190, 50); // Horizontal line

                    // Save the PDF with the student's name
                    doc.save(`certificate_${student.name}.pdf`);
                });
            });
        }
    </script>

</body>
</html>
